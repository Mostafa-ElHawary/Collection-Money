@using Microsoft.AspNetCore.Mvc.Localization
@using Tracker_Money.Resources
@using Tracker_Money.Services
@inject IViewLocalizer Localizer
@inject ILanguageService LanguageService

@{
    var isRtl = LanguageService.IsRightToLeft;
    var currentCulture = LanguageService.CurrentCulture.Name;
}

<!DOCTYPE html>
<html lang="@currentCulture" dir="@(isRtl ? "rtl" : "ltr")">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Financial Dashboard</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">


    <!-- Updated to reference separate CSS files for better organization -->
    @* <link href="~/css/layout.css" rel="stylesheet" /> *@
    @* <link href="~/css/Components/Pager.css" rel="stylesheet" />  *@
        @* <link href="~/css/Customer/Index.css" rel="stylesheet" />   *@
    @* <link href="~/css/Customer/Customer-Search-Result.css" rel="stylesheet" /> *@
     <link href="~/css/Customer/Create.css" rel="stylesheet" />  
    @* <link href="~/css/Customer/Details.css" rel="stylesheet" /> *@
    @* <link href="~/css/Customer/contract-summary.css" rel="stylesheet" /> *@
    @* <link href="~/css/Customer/Edit.css" rel="stylesheet" /> *@
     <link href="~/css/Customer/Delete.css" rel="stylesheet" /> 

    <!-- Contract-specific styles -->
     @* <link href="~/css/Contract/Index.css" rel="stylesheet" />   *@
    @* <link href="~/css/Contract/Details.css" rel="stylesheet" /> *@
   @* <link href="~/css/Contract/Create.css" rel="stylesheet" /> *@
    @* <link href="~/css/Contract/Edit.css" rel="stylesheet" /> *@
    @* <link href="~/css/Contract/Delete.css" rel="stylesheet" /> *@
    @* <link href="~/css/Contract/ContractInstallments.css" rel="stylesheet" /> *@
    @* <link href="~/css/Contract/ContractPayments.css" rel="stylesheet" /> *@
    @* <link href="~/css/Contract/Installments.css" rel="stylesheet" /> *@

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/layout.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Components/Pager.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/rtl.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/financial-rtl-fix.css" asp-append-version="true" />

    @await RenderSectionAsync("Styles", required: false)

</head>
<body class="financial-dashboard-body">
    <!-- Top Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark financial-navbar fixed-top">
        <div class="container-fluid">
            <!-- Logo and Brand -->
            <a class="navbar-brand financial-brand" href="/">
                <i class="fas fa-chart-line me-2"></i>
                <span class="brand-text">@Localizer["AppName"] </span>
            </a>

            <!-- Mobile Toggle Button -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- Navigation Items -->
            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Search Bar -->
                <div class="navbar-nav me-auto">
                    <form class="d-flex financial-search-form ms-3">
                        <div class="search-container">
                            <input class="form-control financial-search" type="search" placeholder="@Localizer["SearchPlaceholder"]" aria-label="@Localizer["Search"]">
                            <button class="btn search-btn" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Right Side Navigation -->
                <ul class="navbar-nav">
                    <!-- Notifications -->
                    <li class="nav-item dropdown">
                        <a class="nav-link financial-nav-link" href="#" id="notificationsDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge">3</span>
                        </a>
                        <ul class="dropdown-menu financial-dropdown">
                            <li><h6 class="dropdown-header">@Localizer["Notifications"]</h6></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-exclamation-circle me-2"></i>@Localizer["PaymentOverdue"]</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-info-circle me-2"></i>@Localizer["NewContractCreated"]</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-check-circle me-2"></i>@Localizer["PaymentReceived"]</a></li>
                        </ul>
                    </li>

                    <!-- User Profile -->
                    <li class="nav-item dropdown">
                        <a class="nav-link financial-nav-link" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown">
                            <div class="user-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <span class="user-name">@Localizer["AdminUser"]</span>
                        </a>
                        <ul class="dropdown-menu financial-dropdown">
                            <li><h6 class="dropdown-header">@Localizer["Account"]</h6></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-user-cog me-2"></i>@Localizer["ProfileSettings"]</a></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>@Localizer["Preferences"]</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <div class="dropdown-item">
                                    <i class="fas fa-language me-2"></i>@Localizer["Language"]
                                    <div class="mt-2">
                                        <form id="language-form" asp-controller="Language" asp-action="SetLanguage" method="post">
                                            <input type="hidden" name="returnUrl" value="@Context.Request.Path@Context.Request.QueryString" />
                                            <div class="d-flex gap-2">
                                                <button type="submit" name="culture" value="en" class="btn @(currentCulture == "en" ? "btn-primary" : "btn-outline-primary") btn-sm">
                                                    @Localizer["English"]
                                                </button>
                                                <button type="submit" name="culture" value="ar" class="btn @(currentCulture == "ar" ? "btn-primary" : "btn-outline-primary") btn-sm">
                                                    @Localizer["Arabic"]
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="#"><i class="fas fa-sign-out-alt me-2"></i>@Localizer["Logout"]</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Sidebar -->
    <div class="financial-sidebar" id="sidebar">
        <div class="sidebar-content">
            <!-- Dashboard Navigation -->
            <div class="sidebar-section">
                <h6 class="sidebar-heading">@Localizer["Dashboard"]</h6>
                <ul class="sidebar-nav">
                    <li class="nav-item">
                        <a class="nav-link active" href="/">
                            <i class="fas fa-tachometer-alt"></i>
                            <span>@Localizer["Overview"]</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Customer">
                            <i class="fas fa-users"></i>
                            <span>@Localizer["Customers"]</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Contract">
                            <i class="fas fa-file-contract"></i>
                            <span>@Localizer["Contracts"]</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Payment">
                            <i class="fas fa-credit-card"></i>
                            <span>@Localizer["Payments"]</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Financial Section -->
            <div class="sidebar-section">
                <h6 class="sidebar-heading">Financial</h6>
                <ul class="sidebar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/Reports">
                            <i class="fas fa-chart-bar"></i>
                            <span>@Localizer["Reports"]</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Analytics">
                            <i class="fas fa-analytics"></i>
                            <span>@Localizer["Analytics"]</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Invoices">
                            <i class="fas fa-file-invoice"></i>
                            <span>@Localizer["Invoices"]</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Settings Section -->
            <div class="sidebar-section">
                <h6 class="sidebar-heading">@Localizer["Settings"]</h6>
                <ul class="sidebar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="/Settings">
                            <i class="fas fa-cog"></i>
                            <span>@Localizer["SystemSettings"]</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/Users">
                            <i class="fas fa-user-shield"></i>
                            <span>@Localizer["UserManagement"]</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Sidebar Toggle Button -->
        <button class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-chevron-left"></i>
        </button>
    </div>

    <!-- Main Content Area -->
    <main class="financial-main-content">
        <div class="container-fluid">
            @RenderBody()
        </div>
    </main>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>